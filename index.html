<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Trade Trinity</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000000">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      text-align: center;
      background: #000;
      color: white;
    }
    .gold {
      color: #D4AF37;
    }
    .circle {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: conic-gradient(green 70%, red 30%);
      margin: 30px auto;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      font-weight: bold;
    }
    .card-row {
      display: flex;
      justify-content: space-around;
      margin: 20px;
    }
    .card {
      background: #111;
      padding: 15px;
      border-radius: 10px;
      width: 28%;
    }
    .btn {
      background: #D4AF37;
      padding: 14px 30px;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      margin-top: 25px;
      cursor: pointer;
    }
    .name {
      position: fixed;
      bottom: 10px;
      right: 15px;
      font-size: 12px;
      color: #D4AF37;
    }
  </style>
</head>

<body>

  <h1 class="gold">TRADE TRINITY</h1>
  <p class="gold">Structure Discipline Profits</p>

  <div class="circle">
    70%
  </div>

  <div class="card-row">
    <div class="card">
      <h3>Total Trades</h3>
      <p id="totalTrades">0</p>
    </div>
    <div class="card">
      <h3>Winrate</h3>
      <p id="winRate">70%</p>
    </div>
    <div class="card">
      <h3>Avg R:R</h3>
      <p id="avgRR">0.0</p>
    </div>
  </div>

 <button class="btn" id="newTradeBtn">+ New Trade</button> 

  <div class="name">ADARSH UMESH MENDON</div>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
  import { 
  getAuth, 
  createUserWithEmailAndPassword, 
  signInWithEmailAndPassword,
  sendPasswordResetEmail,
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
  
import { 
  getFirestore, 
  collection, 
  addDoc, 
  getDocs 
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";
  const firebaseConfig = {
    apiKey: "AIzaSyDPMSmppyUouvyzbrr-NDGWQCBBbtoaDls",
    authDomain: "trade-trinity-185e3.firebaseapp.com",
    projectId: "trade-trinity-185e3",
    storageBucket: "trade-trinity-185e3.firebasestorage.app",
    messagingSenderId: "816692119340",
    appId: "1:816692119340:web:7165d8c4ae85d6ff420e89"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  console.log("Firebase Connected Successfully");
  
document.getElementById("newTradeBtn").addEventListener("click", () => {
  document.body.insertAdjacentHTML("beforeend", `
<div id="tradeModal" style="
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.8);
    display:flex;
    justify-content:center;
    align-items:center;
">
    <div style="
        background:#111;
        padding:25px;
        border-radius:12px;
        width:300px;
        text-align:center;
    ">
        <h3 style="color:#D4AF37;">Add New Trade</h3>
        <input id="pairInput" placeholder="Pair (e.g BTCUSD)" style="width:100%;margin:8px 0;padding:8px;">
        <input id="resultInput" placeholder="Result (Win/Loss)" style="width:100%;margin:8px 0;padding:8px;">
        <input id="rrInput" placeholder="R:R (e.g 2.5)" style="width:100%;margin:8px 0;padding:8px;">

<button id="saveTradeBtn"
    style="margin-top:10px;padding:8px 15px;background:#D4AF37;border:none;">
    Save Trade
</button>

<button onclick="document.getElementById('tradeModal').remove()"
    style="margin-top:10px;padding:8px 15px;background:#444;border:none;color:white;">
    Close
</button>
      
    </div>
</div>
`);


document.getElementById("saveTradeBtn").addEventListener("click", async () => {
    const result = document.getElementById("resultInput").value.toLowerCase();
    const rr = parseFloat(document.getElementById("rrInput").value);
const user = auth.currentUser;

if (!user) {
  alert("User not logged in");
  return;
}

await addDoc(collection(db, "trades"), {
  uid: user.uid,
  pair: document.getElementById("pairInput").value,
  result: result,
  rr: rr,
  createdAt: new Date()
});
    let totalTrades = parseInt(document.getElementById("totalTrades").innerText);
    let wins = parseInt(document.getElementById("winRate").dataset.wins || 0);
    let totalRR = parseFloat(document.getElementById("avgRR").dataset.totalrr || 0);

    totalTrades++;

    if(result === "win"){
        wins++;
        totalRR += rr;
    }

    const winPercentage = ((wins / totalTrades) * 100).toFixed(0);
    const avgRR = wins > 0 ? (totalRR / wins).toFixed(2) : 0;

    document.getElementById("totalTrades").innerText = totalTrades;
    document.getElementById("winRate").innerText = winPercentage + "%";
    document.getElementById("avgRR").innerText = avgRR;

    document.getElementById("winRate").dataset.wins = wins;
    document.getElementById("avgRR").dataset.totalrr = totalRR;

    document.getElementById("tradeModal").remove();
});
// ================= LOGIN POPUP =================

function showLoginPopup() {
  document.body.insertAdjacentHTML("beforeend", `
  <div id="loginModal" style="
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,0.9);
      display:flex;
      justify-content:center;
      align-items:center;
  ">
      <div style="
          background:#111;
          padding:30px;
          border-radius:12px;
          width:300px;
          text-align:center;
      ">
          <h3 style="color:#D4AF37;">Login / Sign Up</h3>

          <input id="emailInput" placeholder="Email"
              style="width:100%;margin:8px 0;padding:8px;">

          <input id="passwordInput" type="password"
              placeholder="Password"
              style="width:100%;margin:8px 0;padding:8px;">

          <button id="loginBtn"
              style="margin-top:10px;padding:8px 15px;background:#D4AF37;border:none;width:100%;">
              Login
          </button>

          <button id="signupBtn"
              style="margin-top:10px;padding:8px 15px;background:#444;border:none;color:white;width:100%;">
              Sign Up
          </button>

          <button id="resetBtn"
              style="margin-top:10px;padding:8px 15px;background:#222;border:none;color:#D4AF37;width:100%;">
              Forgot Password
          </button>
      </div>
  </div>
  `);

  // LOGIN
  document.getElementById("loginBtn").onclick = async () => {
    const email = document.getElementById("emailInput").value;
    const password = document.getElementById("passwordInput").value;

    try {
      await signInWithEmailAndPassword(auth, email, password);
      document.getElementById("loginModal").remove();
    } catch (error) {
      alert(error.message);
    }
  };

  // SIGNUP
  document.getElementById("signupBtn").onclick = async () => {
    const email = document.getElementById("emailInput").value;
    const password = document.getElementById("passwordInput").value;

    try {
      await createUserWithEmailAndPassword(auth, email, password);
      alert("Account created successfully!");
    } catch (error) {
      alert(error.message);
    }
  };

  // RESET PASSWORD
  document.getElementById("resetBtn").onclick = async () => {
    const email = document.getElementById("emailInput").value;

    try {
      await sendPasswordResetEmail(auth, email);
      alert("Password reset email sent!");
    } catch (error) {
      alert(error.message);
    }
  };
}

// Auto show login if not logged in
onAuthStateChanged(auth, (user) => {
  if (!user) {
    showLoginPopup();
  }
});
});

</script>
  
</body>
      </html>
